import{s as F,k as q,o as B,i as C,f as d,e as w,a as E,c as T,b as A,g as P,p as g,u as U,h as _,v as I,q as R,w as M,x as Z,t as y,d as v,m as Y,j as N}from"../chunks/scheduler.BEXlFcv1.js";import{S as G,i as H,c as J,a as K,m as Q,t as W,b as X,d as $}from"../chunks/index.7KKCNSNY.js";import{A as x}from"../chunks/AuthCheck.Crkob2Dq.js";import{c as ee,u as te,h as j,j as se,w as le,i as D}from"../chunks/firebase.BwfJqXMx.js";function ie(n){let e,s,i,t,l,a,b,o,h,f=n[1]&&L(n),c=!n[3]&&n[5]&&O(),m=n[3]&&!n[2]&&!n[1]&&S(n),p=n[2]&&n[3]&&!n[1]&&V(n);return{c(){e=w("form"),s=w("input"),i=E(),t=w("div"),f&&f.c(),l=E(),c&&c.c(),a=E(),m&&m.c(),b=E(),p&&p.c(),this.h()},l(r){e=T(r,"FORM",{class:!0});var u=A(e);s=T(u,"INPUT",{type:!0,placeholder:!0,class:!0}),i=P(u),t=T(u,"DIV",{class:!0});var k=A(t);f&&f.l(k),l=P(k),c&&c.l(k),a=P(k),m&&m.l(k),b=P(k),p&&p.l(k),k.forEach(d),u.forEach(d),this.h()},h(){g(s,"type","text"),g(s,"placeholder","Username"),g(s,"class","input text w-full"),U(s,"input-error",!n[3]&&n[5]),U(s,"input-warning",n[4]),U(s,"input-success",n[2]&&n[3]&&!n[1]),g(t,"class","my-4 min-h-16 px-8 w-full"),g(e,"class","w-2/5")},m(r,u){C(r,e,u),_(e,s),I(s,n[0]),_(e,i),_(e,t),f&&f.m(t,null),_(t,l),c&&c.m(t,null),_(t,a),m&&m.m(t,null),_(t,b),p&&p.m(t,null),o||(h=[R(s,"input",n[9]),R(s,"input",n[7]),R(e,"submit",M(n[8]))],o=!0)},p(r,u){u&1&&s.value!==r[0]&&I(s,r[0]),u&40&&U(s,"input-error",!r[3]&&r[5]),u&16&&U(s,"input-warning",r[4]),u&14&&U(s,"input-success",r[2]&&r[3]&&!r[1]),r[1]?f?f.p(r,u):(f=L(r),f.c(),f.m(t,l)):f&&(f.d(1),f=null),!r[3]&&r[5]?c||(c=O(),c.c(),c.m(t,a)):c&&(c.d(1),c=null),r[3]&&!r[2]&&!r[1]?m?m.p(r,u):(m=S(r),m.c(),m.m(t,b)):m&&(m.d(1),m=null),r[2]&&r[3]&&!r[1]?p?p.p(r,u):(p=V(r),p.c(),p.m(t,null)):p&&(p.d(1),p=null)},d(r){r&&d(e),f&&f.d(),c&&c.d(),m&&m.d(),p&&p.d(),o=!1,Z(h)}}}function ne(n){let e,s,i=n[6].username+"",t,l,a,b="Upload profile image";return{c(){e=w("p"),s=y("Your username is @"),t=y(i),l=E(),a=w("a"),a.textContent=b,this.h()},l(o){e=T(o,"P",{});var h=A(e);s=v(h,"Your username is @"),t=v(h,i),h.forEach(d),l=P(o),a=T(o,"A",{class:!0,href:!0,"data-svelte-h":!0}),Y(a)!=="svelte-1i17dyg"&&(a.textContent=b),this.h()},h(){g(a,"class","btn btn-primary"),g(a,"href","/login/photo")},m(o,h){C(o,e,h),_(e,s),_(e,t),C(o,l,h),C(o,a,h)},p(o,h){h&64&&i!==(i=o[6].username+"")&&N(t,i)},d(o){o&&(d(e),d(l),d(a))}}}function L(n){let e,s,i,t;return{c(){e=w("p"),s=y("Checking availibility of @"),i=y(n[0]),t=y("..."),this.h()},l(l){e=T(l,"P",{class:!0});var a=A(e);s=v(a,"Checking availibility of @"),i=v(a,n[0]),t=v(a,"..."),a.forEach(d),this.h()},h(){g(e,"class","text-secondary")},m(l,a){C(l,e,a),_(e,s),_(e,i),_(e,t)},p(l,a){a&1&&N(i,l[0])},d(l){l&&d(e)}}}function O(n){let e,s="must be 3-16 characters long, alphanumeric only";return{c(){e=w("p"),e.textContent=s,this.h()},l(i){e=T(i,"P",{class:!0,"data-svelte-h":!0}),Y(e)!=="svelte-1wurl8l"&&(e.textContent=s),this.h()},h(){g(e,"class","text-error text-sm")},m(i,t){C(i,e,t)},d(i){i&&d(e)}}}function S(n){let e,s,i,t;return{c(){e=w("p"),s=y("@"),i=y(n[0]),t=y(" is not available"),this.h()},l(l){e=T(l,"P",{class:!0});var a=A(e);s=v(a,"@"),i=v(a,n[0]),t=v(a," is not available"),a.forEach(d),this.h()},h(){g(e,"class","text-warning text-sm")},m(l,a){C(l,e,a),_(e,s),_(e,i),_(e,t)},p(l,a){a&1&&N(i,l[0])},d(l){l&&d(e)}}}function V(n){let e,s,i;return{c(){e=w("button"),s=y("Confirm username @"),i=y(n[0]),this.h()},l(t){e=T(t,"BUTTON",{class:!0});var l=A(e);s=v(l,"Confirm username @"),i=v(l,n[0]),l.forEach(d),this.h()},h(){g(e,"class","btn btn-success")},m(t,l){C(t,e,l),_(e,s),_(e,i)},p(t,l){l&1&&N(i,t[0])},d(t){t&&d(e)}}}function ae(n){let e;function s(l,a){var b;return(b=l[6])!=null&&b.username?ne:ie}let i=s(n),t=i(n);return{c(){t.c(),e=B()},l(l){t.l(l),e=B()},m(l,a){t.m(l,a),C(l,e,a)},p(l,a){i===(i=s(l))&&t?t.p(l,a):(t.d(1),t=i(l),t&&(t.c(),t.m(e.parentNode,e)))},d(l){l&&d(e),t.d(l)}}}function oe(n){let e,s;return e=new x({props:{$$slots:{default:[ae]},$$scope:{ctx:n}}}),{c(){J(e.$$.fragment)},l(i){K(e.$$.fragment,i)},m(i,t){Q(e,i,t),s=!0},p(i,[t]){const l={};t&4223&&(l.$$scope={dirty:t,ctx:i}),e.$set(l)},i(i){s||(W(e.$$.fragment,i),s=!0)},o(i){X(e.$$.fragment,i),s=!1},d(i){$(e,i)}}}const re=/^(?=[a-zA-Z0-9._]{3,16}$)(?!.*[_.]{2})[^_.].*[^_.]$/;function ue(n,e,s){let i,t,l,a,b;q(n,ee,u=>s(11,a=u)),q(n,te,u=>s(6,b=u));let o="",h=!1,f=!1,c;async function m(){s(2,f=!1),s(1,h=!0),clearTimeout(c),c=setTimeout(async()=>{console.log("Checking availibity of...",o);const u=j(D,"usernames",o),k=await se(u).then(z=>z.exists());s(2,f=!k),s(1,h=!1)},500)}async function p(){console.log("Confirming username",o);const u=le(D);u.set(j(D,"usernames",o),{uid:a==null?void 0:a.uid}),u.set(j(D,"users",a.uid),{username:o,photoURL:(a==null?void 0:a.photoURL)??null,published:!0,bio:"Tell us about yourself",links:[{title:"your title",url:"your url",icon:"custom icon"}]}),await u.commit(),s(0,o=""),s(2,f=!1)}function r(){o=this.value,s(0,o)}return n.$$.update=()=>{n.$$.dirty&1&&s(3,i=(o==null?void 0:o.length)>2&&o.length<16&&re.test(o)),n.$$.dirty&1&&s(5,t=o.length>0),n.$$.dirty&14&&s(4,l=i&&!f&&!h)},[o,h,f,i,l,t,b,m,p,r]}class he extends G{constructor(e){super(),H(this,e,ue,oe,F,{})}}export{he as component};
